# rigz - Rust Parallel Gzip

Fast, parallel gzip replacement. Beats gzip and pigz.

## Quick Commands

```bash
make         # Build + quick benchmark (<30s)
make validate  # Verify output works with gunzip
cargo test   # Unit tests
```

## Key Architecture Decisions

1. **System zlib only** - `flate2` with `features = ["zlib"]`, NOT libz-ng
2. **128KB fixed blocks** - Dynamic sizing regressed performance 14%
3. **Single-thread = direct path** - No optimizer overhead for `-p1`
4. **mmap for >50MB files** - Zero-copy via memmap2
5. **Global rayon pool** - `OnceLock<ThreadPool>` avoids per-call cost

## Performance Rules

- **20 runs** for 1MB tests (CV can be 20%+)
- **10 runs** for 10MB tests
- Use **median** not min
- Target: match gzip single-threaded, beat pigz multi-threaded

## File Map

```
src/
├── main.rs              # CLI
├── compression.rs       # File compression orchestration  
├── parallel_compress.rs # Core: rayon parallel gzip
├── cli.rs               # gzip-compatible args
├── decompression.rs     # Decompression
└── optimization.rs      # Thread/buffer tuning
```

See CONTRIBUTING.md for detailed lessons learned.
